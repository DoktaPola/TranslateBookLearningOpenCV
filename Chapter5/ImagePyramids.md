## [П)|(РС)|(РП) Пирамиды изображений

Пирамиды изображений активно используются в разнообразных приложениях компьютерного зрения. Пирамида изображения - это коллекция изображений, получаемая из исходного изображения путём последовательного сжимания, пока не будет достигнута точка останова (естественно конечной точкой может быть один пиксель). 

Существует два вида пирамид, которые наиболее часто можно встретить в литературе и приложениях: пирамиды Гаусса и Лапласа. Пирамида Гаусса используется для сжатия изображения, а пирамида Лапласа для восстановления изображения с повышенной дискретизацией из слоя в пирамиде.

Для получения слоя *(i+1)* в Гауссовой пирамиде (пусть будет ![Формула 5-5 не найден](Images/Frml_5_5.jpg)) из слоя ![Формула 5-6 не найден](Images/Frml_5_6.jpg), необходимо сначала свернуть этот слой с помощью Гауссового ядра, а затем удалить все четные строки и столбцы. Из этого следует, что каждое последующее изображение будет занимать четверть площади предшественника. Итерационный процесс на исходном изображении ![Формула 5-7 не найдена](Images/Frml_5_7.jpg) дает ту самую пирамиду. OpenCV предоставляет метод генерации каждого слояна основе предыдущего изображения: 

```cpp
	void cvPyrDown(
		 IplImage* 	src
		,IplImage* 	dst
		,IplFilter 	filter = IPL_GAUSSIAN_5x5
	);
```

На момент написания книги, параметр *filter* поддерживал только Гайссово ядро 5x5.

Аналогичным образом, можно преобразовать существующее изображение, получив в два раза большее в обоих направлениях изображение, подобной (но не обратной) операцией: 

```cpp
	void cvPyrUp(
		 IplImage* 	src
		,IplImage* 	dst
		,IplFilter 	filter = IPL_GAUSSIAN_5x5
	);
```

В данном случае, изображение сначала преобразуется в два раза большее в обоих направлениях изображение, с новыми строками, заполнеными 0s. Затем выполняется свертка по заданному фильтру (на самом деле, фильтр в два раза больше для каждого измерения, чем указано) для аппроксимации значений "отсутствующих" пикселей.

Ранее было отмечено, что *PyrUp()* не является обратной *PyrDown()*. Это очевидно, т.к. *PyrDown()* приводит к потери данных. Для восстановления оригинального изображения (с более высоким разрешением), требуется та самая теряемая при сжатии изображения, информация. Эти данные формируют пирамиду Лапласа. i-ый слой пирамиды Лапласа определяется следующим образом: 

![Формула 5-8 не найдена](Images/Frml_5_8.jpg)

Оператор *UP()* конвертирует каждый пиксель *(x, y)* исходного изображения в пиксель *(2x + 1, 2y + 1)* в конечном изображении; символ ⊗ обозначает свертку; ![Формула 5-9 не найдена](Images/Frml_5-9.jpg) Гауссово ядро размером 5x5. Конечно, формула является определением оператора *PyrUp()*. Следовательно, оператор Лапласа можно определять следующим образом:

![Формула 5-10 не найдена](Images/Frml_5_10.jpg)

Пирамиды Гауса и Лапласа схематично изображены на рисунке 5-21, на котором так же показан обратный процесс для восстановления исходного изображения по субизображению. 